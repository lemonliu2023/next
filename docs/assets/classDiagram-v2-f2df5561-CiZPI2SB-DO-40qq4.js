import{z,K as A,Y as K}from"./styles-991ebdfc-D2czhm50-vqBRGHEg.js";import{l as p,c as d,h as k,y as Y,t as q,o as B,q as C,j as _}from"./mermaid.core-CrY0-6Yn-BCmlA074.js";import{Z as G}from"./graph-Cx5EwEy7-GYA7QWYq.js";import{b as O}from"./index-fc10efb0-CLMuuZ8X-D6mV-wrV.js";import"./data-BeaF1kZy.js";import"./layout-ITPnmHON-D2jDJtoY.js";import{j as $}from"./step-CFLd_UlD-CAA9ZoWn.js";import"./index-FW1nyG-2.js";import"./clone-Cyudgv5A-pHqDk2J_.js";import"./edges-d32062c0-BiaolFre-CozmDH3a.js";import"./createText-6b48ae7d-Brm7TOmQ-CV-_Q0oc.js";import"./line-C3s158m--QyAb1aCS.js";import"./array-CqVTtuYm-C3YJfAyO.js";import"./path-H8vhG2aR-T6_P2E4R.js";const S=a=>_.sanitizeText(a,d());let T={dividerMargin:10,padding:5,textHeight:10,curve:void 0};const P=function(a,t,u,s){const e=Object.keys(a);p.info("keys:",e),p.info(a),e.forEach(function(c){var r,l,n;const i=a[c],y={shape:"rect",id:i.id,domId:i.domId,labelText:S(i.id),labelStyle:"",style:"fill: none; stroke: black",padding:(r=(l=d().flowchart)==null?void 0:l.padding)!=null?r:(n=d().class)==null?void 0:n.padding};t.setNode(i.id,y),I(i.classes,t,u,s,i.id),p.info("setNode",y)})},I=function(a,t,u,s,e){const c=Object.keys(a);p.info("keys:",c),p.info(a),c.filter(r=>a[r].parent==e).forEach(function(r){var l,n,i,y;const o=a[r],b=o.cssClasses.join(" "),g=B(o.styles),m=(l=o.label)!=null?l:o.id,f=0,h={labelStyle:g.labelStyle,shape:"class_box",labelText:S(m),classData:o,rx:f,ry:f,class:b,style:g.style,id:o.id,domId:o.domId,tooltip:s.db.getTooltip(o.id,e)||"",haveCallback:o.haveCallback,link:o.link,width:o.type==="group"?500:void 0,type:o.type,padding:(n=(i=d().flowchart)==null?void 0:i.padding)!=null?n:(y=d().class)==null?void 0:y.padding};t.setNode(o.id,h),e&&t.setParent(o.id,e),p.info("setNode",h)})},Q=function(a,t,u,s){p.info(a),a.forEach(function(e,c){var r,l,n;const i=e,y="",o={labelStyle:"",style:""},b=i.text,g=0,m={labelStyle:o.labelStyle,shape:"note",labelText:S(b),noteData:i,rx:g,ry:g,class:y,style:o.style,id:i.id,domId:i.id,tooltip:"",type:"note",padding:(r=(l=d().flowchart)==null?void 0:l.padding)!=null?r:(n=d().class)==null?void 0:n.padding};if(t.setNode(i.id,m),p.info("setNode",m),!i.class||!(i.class in s))return;const f=u+c,h={id:`edgeNote${f}`,classes:"relation",pattern:"dotted",arrowhead:"none",startLabelRight:"",endLabelLeft:"",arrowTypeStart:"none",arrowTypeEnd:"none",style:"fill:none",labelStyle:"",curve:C(T.curve,$)};t.setEdge(i.id,i.class,h,f)})},W=function(a,t){const u=d().flowchart;let s=0;a.forEach(function(e){var c,r;s++;const l={classes:"relation",pattern:e.relation.lineType==1?"dashed":"solid",id:`id_${e.id1}_${e.id2}_${s}`,arrowhead:e.type==="arrow_open"?"none":"normal",startLabelRight:e.relationTitle1==="none"?"":e.relationTitle1,endLabelLeft:e.relationTitle2==="none"?"":e.relationTitle2,arrowTypeStart:j(e.relation.type1),arrowTypeEnd:j(e.relation.type2),style:"fill:none",labelStyle:"",curve:C(u==null?void 0:u.curve,$)};if(p.info(l,e),e.style!==void 0){const n=B(e.style);l.style=n.style,l.labelStyle=n.labelStyle}e.text=e.title,e.text===void 0?e.style!==void 0&&(l.arrowheadStyle="fill: #333"):(l.arrowheadStyle="fill: #333",l.labelpos="c",((c=(r=d().flowchart)==null?void 0:r.htmlLabels)!=null?c:d().htmlLabels)?(l.labelType="html",l.label='<span class="edgeLabel">'+e.text+"</span>"):(l.labelType="text",l.label=e.text.replace(_.lineBreakRegex,`
`),e.style===void 0&&(l.style=l.style||"stroke: #333; stroke-width: 1.5px;fill:none"),l.labelStyle=l.labelStyle.replace("color:","fill:"))),t.setEdge(e.id1,e.id2,l,s)})},Z=function(a){T={...T,...a}},H=async function(a,t,u,s){var e,c,r,l;p.info("Drawing class - ",t);const n=(e=d().flowchart)!=null?e:d().class,i=d().securityLevel;p.info("config:",n);const y=(c=n==null?void 0:n.nodeSpacing)!=null?c:50,o=(r=n==null?void 0:n.rankSpacing)!=null?r:50,b=new G({multigraph:!0,compound:!0}).setGraph({rankdir:s.db.getDirection(),nodesep:y,ranksep:o,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),g=s.db.getNamespaces(),m=s.db.getClasses(),f=s.db.getRelations(),h=s.db.getNotes();p.info(f),P(g,b,t,s),I(m,b,t,s),W(f,b),Q(h,b,f.length+1,m);let w;i==="sandbox"&&(w=k("#i"+t));const L=i==="sandbox"?k(w.nodes()[0].contentDocument.body):k("body"),E=L.select(`[id="${t}"]`),M=L.select("#"+t+" g");if(await O(M,b,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",t),Y.insertTitle(E,"classTitleText",(l=n==null?void 0:n.titleTopMargin)!=null?l:5,s.db.getDiagramTitle()),q(b,E,n==null?void 0:n.diagramPadding,n==null?void 0:n.useMaxWidth),!(n!=null&&n.htmlLabels)){const N=i==="sandbox"?w.nodes()[0].contentDocument:document,R=N.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const x of R){const D=x.getBBox(),v=N.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("rx",0),v.setAttribute("ry",0),v.setAttribute("width",D.width),v.setAttribute("height",D.height),x.insertBefore(v,x.firstChild)}}};function j(a){let t;switch(a){case 0:t="aggregation";break;case 1:t="extension";break;case 2:t="composition";break;case 3:t="dependency";break;case 4:t="lollipop";break;default:t="none"}return t}const J={setConf:Z,draw:H},ce={parser:z,db:A,renderer:J,styles:K,init:a=>{a.class||(a.class={}),a.class.arrowMarkerAbsolute=a.arrowMarkerAbsolute,A.clear()}};export{ce as diagram};
