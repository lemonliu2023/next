var d=Object.defineProperty;var f=(s,e,n)=>e in s?d(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var t=(s,e,n)=>f(s,typeof e!="symbol"?e+"":e,n);import{j as a}from"./index-CgyQiIaO.js";import{G as L,u as P}from"./useInitAll-CZsFa0QU.js";import{b as g}from"./points-C26p6jvW.js";import{i as c,c as M,G as x}from"./index-MnfzJUfA.js";import{t as h}from"./index-DcSVnzJh.js";class G{constructor(e,n){t(this,"name");t(this,"scene");t(this,"options");t(this,"mesh");t(this,"material");t(this,"geometry");t(this,"animationId");t(this,"points",[]);t(this,"cur",0);t(this,"brokenCur",0);t(this,"glowPlaneLineMeshInsList",[]);this.name="BrokenGlowPlaneLineMesh",this.scene=e;const i={points:[],glowPlaneLineOptions:c};this.options=Object.assign(i,{...n,glowPlaneLineOptions:{...c,...n==null?void 0:n.glowPlaneLineOptions}})}createMesh(){const{glowPlaneLineOptions:{glowColor:e,glowRate:n,centerColor:i}}=this.options;this.material=M(e,i,n),this.mesh=new L;const{points:o}=this.options;return o.forEach(([r,m])=>{var l;const p=h(r),u=h(m),w=new x(this.scene,{start:p,end:u,material:this.material}).createMesh();(l=this.mesh)==null||l.add(w)}),this.mesh}addToScene(){this.createMesh(),this.startAnimation(performance.now()),this.scene.add(this.mesh)}startAnimation(e){if(!e||!this.material){console.error(`${this.name}动画开始依赖的动画开始时间或材质缺失，请检查`);return}const{speed:n}=this.options.glowPlaneLineOptions,o=(performance.now()-e)*.001;this.material.uniforms.u_amplitude.value=Math.sin(2*o*Math.PI*n),this.animationId=requestAnimationFrame(()=>this.startAnimation(e))}stopAnimation(){}}const v=()=>{const s=React.useRef(),e=g.map(o=>[o.x,o.y,o.z]),n=[];e.reduce((o,r)=>(n.push([o,r]),r));const{sceneRef:i}=P("threejs-examples");return React.useEffect(()=>{s.current=new G(i.current,{points:n}),s.current.addToScene()},[i,s,e]),a.jsx(a.Fragment,{children:a.jsx("div",{className:"threejs-examples-main",children:a.jsx("div",{id:"threejs-examples"})})})};export{v as default};
